{"version":3,"sources":["webpack:///./src/auth/auth.service.ts","webpack:///./src/user/user.service.ts"],"names":[],"mappings":";;;;;;;;;;;AAAa;AACb;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,+DAA+D,gBAAgB,EAAE,EAAE;AAC9G;AACA,mCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,kCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,+BAA+B,qFAAqF;AACpH;AACA,KAAK;AACL;AACA,8CAA8C,cAAc;AAC5D,iBAAiB,mBAAO,CAAC,sCAAgB;AACzC,uBAAuB,mBAAO,CAAC,wDAAsB;AACrD,kCAAkC,mBAAO,CAAC,gFAAkC;AAC5E,cAAc,mBAAO,CAAC,gCAAa;AACnC,0BAA0B,mBAAO,CAAC,gEAA0B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC,gFAAgF,8CAA8C;AAC9H;AACA,iGAAiG,cAAc;AAC/G;AACA,oFAAoF,sBAAsB;AAC1G,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACtDa;AACb;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,oCAAoC;AACvE;AACA;AACA,2BAA2B,+DAA+D,gBAAgB,EAAE,EAAE;AAC9G;AACA,mCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,kCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,+BAA+B,qFAAqF;AACpH;AACA,KAAK;AACL;AACA,8CAA8C,cAAc;AAC5D,iBAAiB,mBAAO,CAAC,sCAAgB;AACzC,kBAAkB,mBAAO,CAAC,wCAAiB;AAC3C,kBAAkB,mBAAO,CAAC,wBAAS;AACnC,sBAAsB,mBAAO,CAAC,8DAAsB;AACpD,kCAAkC,mBAAO,CAAC,gFAAkC;AAC5E,0BAA0B,mBAAO,CAAC,gEAA0B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,uFAAuF,cAAc;AACrG,SAAS;AACT;AACA;AACA;AACA,sDAAsD,WAAW;AACjE;AACA;AACA;AACA;AACA;AACA,wFAAwF,SAAS;AACjG;AACA,oFAAoF,SAAS;AAC7F,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA,gDAAgD,WAAW;AAC3D;AACA;AACA;AACA;AACA;AACA,4FAA4F,SAAS;AACrG;AACA,wFAAwF,SAAS;AACjG;AACA,oFAAoF,SAAS;AAC7F,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA,gDAAgD,WAAW;AAC3D,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.a13cc4496841bd2d661b.hot-update.js","sourcesContent":["\"use strict\";\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst common_1 = require(\"@nestjs/common\");\r\nconst user_service_1 = require(\"../user/user.service\");\r\nconst pasword_hashing_service_1 = require(\"../utils/pasword.hashing.service\");\r\nconst jwt_1 = require(\"@nestjs/jwt\");\r\nconst response_entity_1 = require(\"../utils/response.entity\");\r\nlet AuthService = class AuthService {\r\n    constructor(userService, jwtService) {\r\n        this.userService = userService;\r\n        this.jwtService = jwtService;\r\n    }\r\n    login(loginRequest) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!(loginRequest && loginRequest.userName && loginRequest.password)) {\r\n                return response_entity_1.ResponseEntity.failureWithMessage(\"Username and password are required!\");\r\n            }\r\n            return this.userService.getUser(loginRequest.userName)\r\n                .then(user => {\r\n                if (user) {\r\n                    if (pasword_hashing_service_1.comparePasswordsSync(loginRequest.password, user.password)) {\r\n                        let payload = { userName: user.userName, sub: user.id };\r\n                        return response_entity_1.ResponseEntity.successWithAny({ access_token: this.jwtService.sign(payload) });\r\n                    }\r\n                    return response_entity_1.ResponseEntity.failureWithMessage(`Provided User '${user.userName}' password is incorect, please try again`);\r\n                }\r\n                return response_entity_1.ResponseEntity.failureWithMessage(`User '${loginRequest.userName}' not found`);\r\n            });\r\n        });\r\n    }\r\n};\r\nAuthService = __decorate([\r\n    common_1.Injectable(),\r\n    __metadata(\"design:paramtypes\", [user_service_1.UserService,\r\n        jwt_1.JwtService])\r\n], AuthService);\r\nexports.AuthService = AuthService;\r\n","\"use strict\";\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst common_1 = require(\"@nestjs/common\");\r\nconst typeorm_1 = require(\"@nestjs/typeorm\");\r\nconst typeorm_2 = require(\"typeorm\");\r\nconst user_entity_1 = require(\"./entity/user.entity\");\r\nconst pasword_hashing_service_1 = require(\"../utils/pasword.hashing.service\");\r\nconst response_entity_1 = require(\"../utils/response.entity\");\r\nlet UserService = class UserService {\r\n    constructor(userRepository) {\r\n        this.userRepository = userRepository;\r\n    }\r\n    createUser(userDTO) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return yield pasword_hashing_service_1.encryptPassword(userDTO.password)\r\n                .then(encrypted => {\r\n                userDTO.password = encrypted;\r\n                return userDTO;\r\n            })\r\n                .then(user => this.userRepository.create(user))\r\n                .then(user => this.saveUser(user))\r\n                .then(user => response_entity_1.ResponseEntityFor.successWith(`User '${user.userName}' created successfuly`));\r\n        });\r\n    }\r\n    updateUser(userDTO, userName) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return yield this.userRepository.findOne({ userName })\r\n                .then(user => {\r\n                if (user) {\r\n                    user.firstName = userDTO.firstName;\r\n                    user.lastName = userDTO.lastName;\r\n                    user.userName = userDTO.userName;\r\n                    return response_entity_1.ResponseEntity.successWithMessage(`User '${userName}' updated successfuly`);\r\n                }\r\n                return response_entity_1.ResponseEntity.failureWithMessage(`User '${userName}' does not exist.`);\r\n            });\r\n        });\r\n    }\r\n    updatePassword(userName, oldPassword, newPassword) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return this.userRepository.findOne({ userName })\r\n                .then(user => {\r\n                if (user) {\r\n                    if (pasword_hashing_service_1.comparePasswordsSync(oldPassword, user.password)) {\r\n                        user.password = pasword_hashing_service_1.encryptPasswordSync(newPassword);\r\n                        ;\r\n                        return response_entity_1.ResponseEntity.successWithMessage(`User '${userName}' password updated successfuly`);\r\n                    }\r\n                    return response_entity_1.ResponseEntity.failureWithMessage(`User '${userName}' provided wrong password, please try again.`);\r\n                }\r\n                return response_entity_1.ResponseEntity.failureWithMessage(`User '${userName}' does not exist.`);\r\n            });\r\n        });\r\n    }\r\n    getUser(userName) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return this.userRepository.findOne({ userName });\r\n        });\r\n    }\r\n    getUsers() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return this.userRepository.find();\r\n        });\r\n    }\r\n    saveUser(user) {\r\n        return this.userRepository.save(user);\r\n    }\r\n};\r\nUserService = __decorate([\r\n    common_1.Injectable(),\r\n    __param(0, typeorm_1.InjectRepository(user_entity_1.User)),\r\n    __metadata(\"design:paramtypes\", [typeorm_2.Repository])\r\n], UserService);\r\nexports.UserService = UserService;\r\n"],"sourceRoot":""}